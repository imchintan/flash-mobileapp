language: node_js
node_js:
  - '11'
sudo: false
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
env:
  matrix:
  - NODE_ENV='test'
script:
  - npm install -g react-native-cli
  - npm install
matrix:
  include:
  - language: android
    os: osx
    jdk: oraclejdk11
    before_cache:
      - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
      - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
    cache:
      directories:
        - $HOME/.gradle/caches/
        - $HOME/.gradle/wrapper/
    sudo: required
    node_js: false
    before_install:
      - nvm install 11
      - node --version
      - yes | sdkmanager "platforms;android-26"
    licenses:
      - android-sdk-license-.+
    install:
      - travis_retry npm install
    android:
      components:
        - build-tools-27.0.3
        - android-27
        - extra-android-m2repository
        - extra-google-google_play_services
        - extra-google-m2repository
        - addon-google_apis-google-16
    script:
      - cd android && ./gradlew clean
